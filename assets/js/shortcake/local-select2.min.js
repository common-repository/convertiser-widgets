sui.views.editAttributeFieldLocalSelect2=sui.views.editAttributeSelect2Field.extend({selector:".shortcode-ui-local-select2",events:{"ordered-change .shortcode-ui-local-select2":"inputChanged"},inputChanged:function(a){var b=jQuery(a.currentTarget).data("preserved-order");Array.isArray(b)&&(b=_.filter(b,function(a){return""!==a}),b=this.model.get("multiple")?b.join(","):b.pop()),this.setValue(b),this.triggerCallbacks()},preselect:function(a){var b=String(this.getValue());b.length&&(b=_.filter(b.split(","),function(a){return""!==a}),a.val(b).data("preserved-order",b).trigger("change"),this.renderSelections(a))},renderSelections:function(a){var b=a.data("preserved-order")||[],c=a.next(".select2-container"),d=c.find("li.select2-selection__choice"),e=d.last().next();b.forEach(function(a){var b=d.filter(function(b,c){return jQuery(c).data("data").id===a});e.before(b)})},selectionHandler:function(a){var b=jQuery(a.currentTarget),c=a.params.data.id,d=b.data("preserved-order")||[];switch(a.type){case"select2:select":d[d.length]=c;break;case"select2:unselect":var e=d.indexOf(c);e>=0&&d.splice(e,1)}b.data("preserved-order",d),this.renderSelections(b),b.trigger("ordered-change")},render:function(){var a={multiple:!1};for(var b in a)this.model.get(b)||this.model.set(b,a[b]);var c=this.model.toJSON();c.id="shortcode-ui-"+this.model.get("attr")+"-"+this.model.cid;var d=[];for(var e in c.meta)"boolean"==typeof c.meta[e]?c.meta[e]&&d.push(_.escape(e)):d.push(_.escape(e)+'="'+_.escape(c.meta[e])+'"');c.meta=d.join(" "),this.$el.html(this.template(c));var f=this.$el.find(this.selector),g=f[shortcodeUIData.select2_handle]({minimumInputLength:0,minimumResultsForSearch:10,data:c.options,multiple:this.model.get("multiple"),dropdownParent:jQuery(".media-modal")}),h=g.select2("data");return h.forEach(function(a){var b=g.data("preserved-order")||[];b[b.length]=a.id,g.data("preserved-order",b)}),g.on("select2:select select2:unselect",this.selectionHandler.bind(this)),this.model.get("multiple")&&this.sortable(f),f.parent().find(".select2-search__field").css({width:"100%"}),g.on("select2:open",function(){jQuery(".media-modal .select2-container").css({"z-index":"auto"})}),this.preselect(f),this}});